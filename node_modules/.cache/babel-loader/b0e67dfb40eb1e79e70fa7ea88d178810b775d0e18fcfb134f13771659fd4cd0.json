{"ast":null,"code":"var _jsxFileName = \"/Users/phoenix/code/vercel/swapcommf/src/pages/AcceptSwapItems.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useQuery, useMutation } from \"@apollo/client\";\nimport { Container, Row, Col, Card, Button, Alert, Form } from \"react-bootstrap\";\nimport { GET_ITEMS_FOR_SWAP } from \"../utils/queries\";\nimport { UPDATE_ITEM_STATUS } from \"../utils/mutations\";\nimport Auth from \"../utils/auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AcceptSwapItems = () => {\n  _s();\n  const {\n    itemToChange\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    loading,\n    data,\n    error\n  } = useQuery(GET_ITEMS_FOR_SWAP, {\n    variables: {\n      itemToChange\n    }\n  });\n  const [updateItemStatus] = useMutation(UPDATE_ITEM_STATUS);\n  const [items, setItems] = useState([]);\n  const [feedback, setFeedback] = useState(\"\"); // New state for feedback\n  const [message, setMessage] = useState(\"\");\n  const [isProcessing, setIsProcessing] = useState(false);\n  useEffect(() => {\n    if (!loading && data) {\n      const filteredItems = data.itemsForSwap.filter(item => item.itemStatus === \"OfferToSwap\");\n      setItems(filteredItems);\n    }\n  }, [loading, data]);\n  const handleAcceptSwap = async (acceptedItemId, requestedByUser, offeredItems) => {\n    setIsProcessing(true);\n    try {\n      // Get the current user's username\n      const currentUser = Auth.getProfile().data.username;\n\n      // Update the status and ownership of the \"requestToSwap\" item\n      await updateItemStatus({\n        variables: {\n          itemId: itemToChange,\n          status: \"Accepted\",\n          //   newOwner: currentUser, // Update to requestByUser value\n          newOwner: 'test3'\n        }\n      });\n\n      // Update the status and ownership of the \"OfferToSwap\" items\n      items.filter(item => item.itemStatus === \"OfferToSwap\").forEach(async offeredItem => {\n        await updateItemStatus({\n          variables: {\n            itemId: offeredItem.id,\n            status: \"Swapped\",\n            //   newOwner: offeredItem.offerToUser, // Update to offerToUser value\n            newOwner: 'test'\n          }\n        });\n      });\n      setMessage(\"Swap accepted successfully.\");\n      navigate(\"/created\");\n    } catch (error) {\n      console.error(\"Error during swap:\", error);\n      setMessage(\"Failed to complete swap.\");\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // New function to handle navigation to the home page\n  const handleCancel = () => {\n    navigate(\"/\"); // Navigates to the home page\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"h1\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(Alert, {\n    variant: \"danger\",\n    children: [\"Error loading items: \", error.message]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 12\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [message && /*#__PURE__*/_jsxDEV(Alert, {\n      variant: message.includes(\"Failed\") ? \"danger\" : \"success\",\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      children: items.map(item => /*#__PURE__*/_jsxDEV(Col, {\n        xs: 12,\n        md: 6,\n        lg: 4,\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Card.Img, {\n            variant: \"top\",\n            src: item.image,\n            alt: item.itemName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n            children: [/*#__PURE__*/_jsxDEV(Card.Title, {\n              children: item.itemName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              controlId: \"feedback\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"Feedback\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                placeholder: \"Enter your feedback\",\n                value: feedback,\n                onChange: e => setFeedback(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 100,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between mt-3\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                variant: \"success\",\n                onClick: () => handleAcceptSwap(item.id, item.requestByUser, items.map(itm => itm.id)),\n                disabled: isProcessing,\n                children: \"Accept Swap\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"secondary\",\n                onClick: handleCancel,\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this)\n      }, item.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n_s(AcceptSwapItems, \"ZdNylVG2hUqx0MG4bwCTMctVMHM=\", false, function () {\n  return [useParams, useNavigate, useQuery, useMutation];\n});\n_c = AcceptSwapItems;\nexport default AcceptSwapItems;\nvar _c;\n$RefreshReg$(_c, \"AcceptSwapItems\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useQuery","useMutation","Container","Row","Col","Card","Button","Alert","Form","GET_ITEMS_FOR_SWAP","UPDATE_ITEM_STATUS","Auth","jsxDEV","_jsxDEV","AcceptSwapItems","_s","itemToChange","navigate","loading","data","error","variables","updateItemStatus","items","setItems","feedback","setFeedback","message","setMessage","isProcessing","setIsProcessing","filteredItems","itemsForSwap","filter","item","itemStatus","handleAcceptSwap","acceptedItemId","requestedByUser","offeredItems","currentUser","getProfile","username","itemId","status","newOwner","forEach","offeredItem","id","console","handleCancel","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","includes","map","xs","md","lg","className","Img","src","image","alt","itemName","Body","Title","Group","controlId","Label","Control","type","placeholder","value","onChange","e","target","onClick","requestByUser","itm","disabled","_c","$RefreshReg$"],"sources":["/Users/phoenix/code/vercel/swapcommf/src/pages/AcceptSwapItems.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useQuery, useMutation } from \"@apollo/client\";\nimport { Container, Row, Col, Card, Button, Alert, Form } from \"react-bootstrap\";\nimport { GET_ITEMS_FOR_SWAP } from \"../utils/queries\";\nimport { UPDATE_ITEM_STATUS } from \"../utils/mutations\";\nimport Auth from \"../utils/auth\";\n\nconst AcceptSwapItems = () => {\n  const { itemToChange } = useParams();\n  const navigate = useNavigate();\n  const { loading, data, error } = useQuery(GET_ITEMS_FOR_SWAP, {\n    variables: { itemToChange },\n  });\n\n  const [updateItemStatus] = useMutation(UPDATE_ITEM_STATUS);\n  const [items, setItems] = useState([]);\n  const [feedback, setFeedback] = useState(\"\"); // New state for feedback\n  const [message, setMessage] = useState(\"\");\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  useEffect(() => {\n    if (!loading && data) {\n      const filteredItems = data.itemsForSwap.filter(\n        (item) => item.itemStatus === \"OfferToSwap\"\n      );\n      setItems(filteredItems);\n    }\n  }, [loading, data]);\n\n  const handleAcceptSwap = async (\n    acceptedItemId,\n    requestedByUser,\n    offeredItems\n  ) => {\n    setIsProcessing(true);\n    try {\n     // Get the current user's username\n     const currentUser = Auth.getProfile().data.username;\n\n     // Update the status and ownership of the \"requestToSwap\" item\n     await updateItemStatus({\n       variables: {\n         itemId: itemToChange,\n         status: \"Accepted\",\n       //   newOwner: currentUser, // Update to requestByUser value\n       newOwner: 'test3'\n       },\n     });\n\n     // Update the status and ownership of the \"OfferToSwap\" items\n     items\n       .filter((item) => item.itemStatus === \"OfferToSwap\")\n       .forEach(async (offeredItem) => {\n         await updateItemStatus({\n           variables: {\n             itemId: offeredItem.id,\n             status: \"Swapped\",\n           //   newOwner: offeredItem.offerToUser, // Update to offerToUser value\n           newOwner: 'test'\n           },\n         });\n       });\n\n     setMessage(\"Swap accepted successfully.\");\n     navigate(\"/created\");\n   } catch (error) {\n     console.error(\"Error during swap:\", error);\n     setMessage(\"Failed to complete swap.\");\n   } finally {\n     setIsProcessing(false);\n   }\n };\n\n  // New function to handle navigation to the home page\n  const handleCancel = () => {\n    navigate(\"/\"); // Navigates to the home page\n  };\n\n  if (loading) return <h1>Loading...</h1>;\n  if (error)\n    return <Alert variant=\"danger\">Error loading items: {error.message}</Alert>;\n\n  return (\n    <Container>\n      {message && (\n        <Alert variant={message.includes(\"Failed\") ? \"danger\" : \"success\"}>\n          {message}\n        </Alert>\n      )}\n      <Row>\n        {items.map((item) => (\n          <Col key={item.id} xs={12} md={6} lg={4}>\n            <Card className=\"mb-3\">\n              <Card.Img variant=\"top\" src={item.image} alt={item.itemName} />\n              <Card.Body>\n                <Card.Title>{item.itemName}</Card.Title>\n                <Form.Group controlId=\"feedback\">\n                  <Form.Label>Feedback</Form.Label>\n                  <Form.Control\n                    type=\"text\"\n                    placeholder=\"Enter your feedback\"\n                    value={feedback}\n                    onChange={(e) => setFeedback(e.target.value)}\n                  />\n                </Form.Group>\n                <div className=\"d-flex justify-content-between mt-3\">\n                  <Button\n                    variant=\"success\"\n                    onClick={() =>\n                      handleAcceptSwap(\n                        item.id,\n                        item.requestByUser,\n                        items.map((itm) => itm.id)\n                      )\n                    }\n                    disabled={isProcessing}\n                  >\n                    Accept Swap\n                  </Button>\n                  <Button\n                    variant=\"secondary\"\n                    onClick={handleCancel}\n                  >\n                    Cancel\n                  </Button>\n                </div>\n              </Card.Body>\n            </Card>\n          </Col>\n        ))}\n      </Row>\n    </Container>\n  );\n};\n\nexport default AcceptSwapItems;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}